<!DOCTYPE html>
<html lang="pt-PT" class="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sess√£o 5: C√¢mara e GSD üì∏</title>
    <!-- Carregar Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Carregar Highlight.js -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap");
      body {
        font-family: "Inter", sans-serif;
      }
      .code-block {
        background-color: #1e293b;
        padding: 1.5rem;
        border-radius: 0.75rem;
        overflow-x: auto;
        position: relative;
      }
      .copy-btn {
        position: absolute;
        top: 10px;
        right: 10px;
        background-color: #3b82f6;
        color: white;
        padding: 5px 10px;
        border-radius: 5px;
        font-size: 0.8rem;
        cursor: pointer;
      }
    </style>
    <script>
      tailwind.config = { darkMode: "class" };
      function copyToClipboard(id) {
        const text = document.getElementById(id).innerText;
        navigator.clipboard.writeText(text);
        alert("C√≥digo copiado! Cola no Astro Pi Replay Tool.");
      }
    </script>
  </head>
  <body
    class="bg-slate-900 text-slate-300 leading-relaxed p-6 md:p-12 max-w-5xl mx-auto"
  >
    <!-- Cabe√ßalho -->
    <header class="mb-12 text-center">
      <h1 class="text-4xl md:text-6xl font-black text-white mb-4">
        Sess√£o 5: C√¢mara e
        <span
          class="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500"
          >GSD</span
        >
      </h1>
      <p class="text-xl text-slate-400 max-w-2xl mx-auto">
        Hoje vamos dominar a fotografia espacial e aprender a medir dist√¢ncias a
        partir do espa√ßo.
      </p>
    </header>

    <!-- Parte 1: GSD e Altitude -->
    <section class="mb-16 bg-slate-800 p-8 rounded-2xl border border-slate-700">
      <h2
        class="text-3xl font-bold text-white mb-6 border-b border-slate-600 pb-2"
      >
        1. O Conceito de GSD
      </h2>

      <div class="grid md:grid-cols-2 gap-8 items-center">
        <div>
          <p class="text-lg mb-4">
            Para calcular a velocidade, precisamos de converter
            <strong>p√≠xeis</strong> (na foto) em
            <strong>quil√≥metros</strong> (na Terra).
          </p>
          <div
            class="bg-indigo-900/30 p-4 rounded-xl border border-indigo-500/30 mb-4"
          >
            <h3 class="font-bold text-indigo-300 text-xl mb-2">
              GSD (Ground Sampling Distance)
            </h3>
            <p>
              √â a dist√¢ncia no ch√£o que corresponde a
              <strong>1 p√≠xel</strong> na imagem.
            </p>
            <p class="mt-2 text-sm text-slate-400">
              Exemplo: Se GSD = 12648 cm/px, ent√£o 1 p√≠xel = 126 metros!
            </p>
          </div>

          <h3 class="font-bold text-white mt-6 mb-2">
            Como a Altitude Afeta o GSD?
          </h3>
          <ul class="list-disc list-inside space-y-2 text-slate-300">
            <li>
              Se a ISS subir (maior altitude) -> V√™ mais √°rea ->
              <strong>Maior GSD</strong>.
            </li>
            <li>
              Se a ISS descer (menor altitude) -> V√™ menos √°rea ->
              <strong>Menor GSD</strong>.
            </li>
          </ul>
        </div>
        <div
          class="bg-black/30 p-6 rounded-xl flex items-center justify-center h-full"
        ></div>
      </div>
    </section>

    <!-- Parte 2: O M√≥dulo da C√¢mara -->
    <section class="mb-16">
      <h2
        class="text-3xl font-bold text-white mb-6 border-b border-slate-700 pb-2"
      >
        2. A C√¢mara (`picamzero`)
      </h2>
      <p class="mb-4 text-lg">
        Vamos come√ßar a programar. No <strong>Astro Pi Replay Tool</strong>,
        usamos a biblioteca `picamzero` para controlar a c√¢mara.
      </p>

      <div class="code-block mb-8">
        <button class="copy-btn" onclick="copyToClipboard('code-basic')">
          Copiar
        </button>
        <pre><code class="python" id="code-basic">
from picamzero import Camera
from time import sleep

# 1. Iniciar a c√¢mara
cam = Camera()

# 2. Tirar uma foto simples
print("A tirar foto...")
cam.take_photo("teste.jpg")
print("Foto tirada!")

# 3. Tirar uma sequ√™ncia (V√°rias fotos seguidas)
# Tira 3 fotos com intervalo de 5 segundos
cam.capture_sequence("sequencia.jpg", num_images=3, interval=5)
</code></pre>
      </div>
    </section>

    <!-- Parte 3: O Desafio dos Timestamps -->
    <section class="mb-16 bg-slate-800 p-8 rounded-2xl border border-slate-700">
      <h2 class="text-3xl font-bold text-white mb-6">3. Desafio: Timestamps</h2>
      <p class="mb-4 text-lg">
        Para calcular a velocidade ($v = d/t$), precisamos do
        <strong>tempo</strong> ($t$) exato entre duas fotos. As fotos digitais
        guardam a hora nos seus metadados (EXIF).
      </p>
      <p class="mb-6 font-bold text-yellow-400">
        Tarefa: Criem um script que tire 2 fotos e imprima a hora exata
        ("Timestamp") de cada uma.
      </p>

      <div class="code-block">
        <button class="copy-btn" onclick="copyToClipboard('code-timestamp')">
          Copiar
        </button>
        <pre><code class="python" id="code-timestamp">
from picamzero import Camera
from time import sleep
from datetime import datetime
from exif import Image  # Biblioteca para ler dados da foto

def obter_hora_da_foto(nome_ficheiro):
    # Abre a imagem e l√™ a data original
    with open(nome_ficheiro, 'rb') as imagem:
        img = Image(imagem)
        # O campo 'datetime_original' tem a hora
        hora_str = img.get("datetime_original")
        return hora_str

# --- O Vosso C√≥digo ---
cam = Camera()

# 1. Tirar Foto 1
cam.take_photo("foto1.jpg")
sleep(5) # Esperar 5 segundos
# 2. Tirar Foto 2
cam.take_photo("foto2.jpg")

# 3. Imprimir as horas
print("Hora da Foto 1:", obter_hora_da_foto("foto1.jpg"))
print("Hora da Foto 2:", obter_hora_da_foto("foto2.jpg"))
</code></pre>
      </div>
    </section>

    <!-- Parte 4: Exemplo Final para o Replay Tool -->
    <section class="mb-12">
      <h2
        class="text-3xl font-bold text-white mb-6 border-b border-slate-700 pb-2"
      >
        4. Exemplo Final (Pronto a Correr)
      </h2>
      <p class="mb-4 text-lg">
        Este √© o c√≥digo completo para a sess√£o de hoje. Ele tira fotos, calcula
        o tempo entre elas e prepara tudo para a pr√≥xima aula (onde vamos
        calcular a velocidade).
      </p>
      <p class="mb-6 text-sm text-slate-400">
        Copiem isto para o `main.py` no Astro Pi Replay Tool.
      </p>

      <div class="code-block">
        <button class="copy-btn" onclick="copyToClipboard('code-final')">
          Copiar
        </button>
        <pre><code class="python" id="code-final">
# --- SESS√ÉO 5: PREPARA√á√ÉO PARA VELOCIDADE ---
from picamzero import Camera
from time import sleep
from datetime import datetime
from exif import Image
import os

def get_time(image_path):
    """L√™ a hora exata dos metadados da imagem"""
    with open(image_path, 'rb') as image_file:
        img = Image(image_file)
        time_str = img.get("datetime_original")
        # Converte texto para objeto de tempo
        time_obj = datetime.strptime(time_str, '%Y:%m:%d %H:%M:%S')
        return time_obj

def get_time_difference(image_1, image_2):
    """Calcula a diferen√ßa em segundos entre duas fotos"""
    time_1 = get_time(image_1)
    time_2 = get_time(image_2)
    difference = time_2 - time_1
    return difference.total_seconds()

# --- EXECU√á√ÉO PRINCIPAL ---
if __name__ == "__main__":
    
    # 1. Configurar C√¢mara
    cam = Camera()
    
    # 2. Definir nomes dos ficheiros
    foto1 = "foto_inicio.jpg"
    foto2 = "foto_fim.jpg"
    
    print("--- INICIANDO CAPTURA ---")
    
    # 3. Tirar a primeira foto
    print(f"A tirar {foto1}...")
    cam.take_photo(foto1)
    
    # 4. Esperar (Simular o movimento da ISS)
    print("A aguardar 5 segundos...")
    sleep(5)
    
    # 5. Tirar a segunda foto
    print(f"A tirar {foto2}...")
    cam.take_photo(foto2)
    
    print("--- FOTOS CAPTURADAS ---")
    
    # 6. Calcular e Mostrar o Tempo
    # (Isto confirma que conseguimos ler os dados EXIF corretamente)
    try:
        tempo_passado = get_time_difference(foto1, foto2)
        print(f"Sucesso! Passaram {tempo_passado} segundos entre as fotos.")
        print("Estamos prontos para calcular a velocidade na pr√≥xima sess√£o!")
    except Exception as e:
        print(f"Erro ao ler tempo: {e}")

</code></pre>
      </div>
    </section>
  </body>
</html>
